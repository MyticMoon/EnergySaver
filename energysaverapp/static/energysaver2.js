(function(){$.widget("gt2.parallaxCycle",{options:{selectors:{bgselector:"[data-parallax-bg]",deepbgselector:"[data-parallax-deepbg]",fgselector:"[data-parallax-fg]",closefgselector:"[data-parallax-closefg]"},cycler:{container:".nav-slider-container",slider:".nav-slider[data-ui-draggable]",menu:".hero-nav",duration:300},hero:{container:".heros",viewport:".hero-container",duration:1500,easing:"easeInOutCubic"}},_create:function(){var a,b,c,d,e,f;return e=this,a=$(this.options.cycler.menu),b=$(this.options.cycler.slider),d=a.find("li").length,this.nav={$menu:a,$slider:b,distance:$(this.options.cycler.container).width()/d,center:b.width()/2,percent:1/d*100},this.nav.$slider.draggable({axis:"x",containment:"parent",start:function(a,b){return b.helper.stop()},stop:function(a,b){var c;return c=Math.floor((b.position.left+e.nav.center)/e.nav.distance),e._moveSlider(c)}}),this.hero={$container:$(this.options.hero.container)},this.nav.$menu.on("click","li",function(){return e._moveSlider(e.nav.$menu.find("li").index(this))}),this.currentSlide=0,f=this.nav.$menu.find("li").append("<span></span>"),this.numSlides=this.nav.$menu.find("li").length,c="",$.each([1,2,3,4],function(a,b){c+=c+".heros .layer"+b+" > *";if(a!==4)return c+=", "}),this.parallax={$elems:this.element.find(c)},$(document).ready(function(){return e.parallax.$elems.each(function(a,b){var c,d;return c=$(b),d={layer1:10,layer2:50,layer3:100,layer4:160},c.data("parallax-width",c.width()),c.data("parallax-factor",d[c.parent().data("parallax-depth")])})}),this.element.on("swipeleft swiperight",function(a){var b;b=a.type==="swipeleft"?e.currentSlide+1:e.currentSlide-1;if(!(b<0||b>=e.numSlides))return e._moveSlider(b)})},_moveSlider:function(a){var b,c,d,e,f;return e=this,b=this.nav.$menu.find("li:nth-child("+(a+1)+")"),d=0,f=a-(this.currentSlide||0),c=this.nav.$slider.width()*a,this.currentSlide=a,b.siblings().removeClass("highlight").end().addClass("highlight"),this.nav.$slider.animate({left:c},{duration:e.options.cycler.duration}),e._moveHero(f),e._trigger("move",{},{slideNum:a})},_moveHero:function(a){var b,c,d;return d=this,b=1600,c=null,this.hero.$container.animate({left:"-="+a*100+"%"},{duration:d.options.hero.duration,easing:d.options.hero.easing}),this.parallax.$elems.each(function(){var b;return b=$(this),b.animate({left:"-="+a*b.data("parallax-factor")+"%"},{duration:d.options.hero.duration,easing:d.options.hero.easing})})},slideNum:function(){return this.currentSlide}})}).call(this),function(){var a;$.widget("gt.herocopy",{options:{duration:800},_create:function(){var a;return a=this,a.$points=$("<div class='hero-points'><div class='opener'></div></div>").appendTo(this.element),a.$actions=$(".hero .action").detach().append("<div class='closer'></div>").appendTo(this.$points),a.$actions.each(function(){var a;return a=$(this),a.css("right","-"+a.width()+"px")}),a.$points.on("click",".opener",function(b){return b.preventDefault(),a.open()}).on("click",".closer",function(b){return b.preventDefault(),a.close(this)}),a.element.bind("parallaxcyclemove",function(b,c){if(a.isopen)return a.close("",250)}),a.isopen=!1},open:function(){var a,b;return b=this,a=b.$actions.eq(b.element.parallaxCycle("slideNum")),a.animate({right:0},{duration:b.options.duration}),b.isopen=a},close:function(a,b){var c,d;return d=this,c=d.isopen||$(a).closest(".action"),c.animate({right:"-"+c.width()+"px"},{duration:b||d.options.duration}),d.isopen=!1}}),$.widget("gt.tweetroll",{options:{tweets:6},_create:function(){var a;return a=this,a._setTimer()},moveTweet:function(){var a,b,c,d,e,f;return e=this,b=e.element.find(".tweet-container"),a=b.filter(".first"),f=-1*Number(a.css("margin-top").replace(/px/,"")),d=a.height(),c=d/e.options.tweets,a.animate({"margin-top":"-="+c+"px"},{duration:300,complete:function(){if(Math.round(d-(f+c+1))<=0)return a.remove(),b.eq(1).addClass("first"),e.element.append("<div class='tweet-container'></div>")}}),e._setTimer()},_setTimer:function(){var a;return a=this,a.timeout=setTimeout(function(){return a.moveTweet.call(a)},Math.ceil(Math.random()*8e3)+2e3)},destroy:function(){return clearTimeout(this.timeout),$.Widget.prototype.destroy.call(this)}}),function(){return $.fn.rotate=function(a,b,c,d,e,f){var g,h;return e==null&&(e="linear"),g=this,h=g.data("coasterscene"),g.animate({top:"+="+Math.round(d*h.options.size)+"px",left:"+="+Math.round(c*h.options.size)+"px","border-spacing":a+360},{step:function(a){return g.css({"-webkit-transform":"rotate("+a+"deg)","-moz-transform":"rotate("+a+"deg)","-ms-transform":"rotate("+a+"deg)","-o-transform":"rotate("+a+"deg)",transform:"rotate("+a+"deg)"})},duration:b,easing:e}),h.options.shadow&&h.options.shadow.animate({left:"+="+c*h.options.size+"px",top:"+="+c*h.options.size/20+"px"},{duration:b,easing:e}),f&&g.queue(function(a){return h[f](),a()}),this},$.widget("gt.coasterscene",{options:{scene:null,shadow:null,size:1},_create:function(){var a;a=this,a.origin={left:a.element.css("left"),top:a.element.css("top"),rotation:a.element.data("coaster-rotation")||0};if(a.options.shadow)return a.shadowOrigin={left:a.options.shadow.css("left"),top:a.options.shadow.css("top")}},destroy:function(){return $.Widget.prototype.destroy.call(this)},reset:function(){var a;a=this,a.element.hide().stop(!0).css({top:"",left:"","-webkit-transform":"rotate("+this.origin.rotation+"deg)","-moz-transform":"rotate("+this.origin.rotation+"deg)","-ms-transform":"rotate("+this.origin.rotation+"deg)","-o-transform":"rotate("+this.origin.rotation+"deg)",transform:"rotate("+this.origin.rotation+"deg)"});if(a.options.shadow)return a.options.shadow.hide().stop(!0).css({left:"",top:""})},run:function(){var a;return a=this,a.element.show(),a.options.shadow&&a.options.shadow.show(),a.options.scene.call(a.element),a.element.queue(function(b){return a.element.hide(),a.options.shadow&&a.options.shadow.hide(),a.reset(),a._trigger("complete"),b()})},rotate:function(a,b,c,d,e){return e==null&&(e="linear"),this.element.rotate(arguments)},addCount:function(){return $(".counter").cyclecounter("addOne")},addLikes:function(){var a,b;return a=$(".fb-like").data("cyclecounter"),b=a.currentNum,a.cycle(b+Math.ceil(Math.random()*30))},_setOption:function(a,b){switch(a){case"size":this.reset()}return $.Widget.prototype._setOption.apply(this,arguments)}})}(),a=function(a,b){var c;c="<div class='nums-container"+b+"'>";for(b=9;b>=0;b--)c+="<div class='num"+b+"'>"+b+"</div>";c+="</div>",a.append(c)},$.widget("gt.cyclecounter",{options:{start:0},_create:function(){var b,c;c=this,c.$cont=c.element.find(".cycle-container"),c.height=c.$cont.height();for(b=0;b<=2;b++)a(c.$cont,b);return c.cycle(c.options.start)},addOne:function(){return this.cycle(this.currentNum+1)},cycle:function(a){var b,c;b=String(a);for(c=0;c<=2;c++)this._cycleTo(c,Number(b[b.length-(c+1)])||0);return this.currentNum=a},_cycleTo:function(a,b){var c,d;return d=this,c=d.element.find(".nums-container"+a),c.animate({top:-1*d.height*(9-b)+"px"},{duration:250})}}),$(function(){var a,b,c,d,e,f,g,h;$(".heros-container").parallaxCycle().herocopy(),$(".counter").cyclecounter({start:Math.ceil(Math.random()*350)}),$(".fb-like").cyclecounter({start:Math.ceil(Math.random()*300)}),$(".tweet-overlay").tweetroll(),c=[".why-so-serious .cart-bg1",".why-so-serious .cart-fg",".why-so-serious .cart-bg2"],$("html").is(".no-csstransforms")||(e=function(){return $(".why-so-serious .cart-fg").coasterscene("run")}),d=function(a){return $(a).bind("coasterscenecomplete",function(){var b;return b=c.indexOf(a),b!==c.length-1?$(c[b+1]).coasterscene("run"):$(c[0]).coasterscene("run")})};for(g=0,h=c.length;g<h;g++)b=c[g],d(b);return $(".heros-container").bind("parallaxcyclemove",function(a,b){return b.slideNum===0?e():$(c.join(", ")).each(function(){return $(this).coasterscene("reset")})}),a=$(window),f=a.width(),$(".why-so-serious .cart-bg1").coasterscene({size:f>935?1:.75,scene:function(){return this.rotate(0,0,0,0).rotate(0,320,-20,0).rotate(10,320,-20,-5).rotate(20,320,-13,-5).rotate(36,340,-18,-10).rotate(47,240,-13,-9).rotate(55,180,-9,-8).rotate(55,1120,-43,-80).rotate(53,400,-11,-20).rotate(47,220,-7,-10).rotate(40,220,-10,-7).rotate(28,220,-10,-5).rotate(13,220,-12,-4).rotate(0,220,-11,-1,"linear","addCount").rotate(-12,220,-11,2).rotate(-19,204,-10,3).rotate(-30,188,-12,5).rotate(-43,188,-11,9).rotate(-54,264,-11,15).rotate(-62,120,-7,11).rotate(-62,496,-48,87,"easeInSine").rotate(-44,108,-22,23).rotate(-34,84,-20,11).rotate(-13,68,-20,5).rotate(0,76,-20,2).rotate(5,130,-25,-4).rotate(7,146,-25,-4).rotate(7,162,-25,-3).rotate(5,178,-25,-3).rotate(0,210,-30,-1).rotate(-5,114,-10,0).rotate(-14,114,-15,3).rotate(-25,122,-20,7).rotate(-35,106,-12,8).rotate(-60,106,-13,15).rotate(-75,90,-10,20).rotate(-95,74,0,20).rotate(-105,58,3,20).rotate(-120,42,5,15).rotate(-135,34,15,15).rotate(-150,34,18,15).rotate(-160,34,20,0).delay(1e3)}}),$(".why-so-serious .cart-fg").coasterscene({size:f>935?1:.75,shadow:$(".why-so-serious .cart-fg-shadow"),scene:function(){return this.rotate(-30,0,0,0).rotate(-30,125,45,-20).rotate(-30,175,45,-20).rotate(-30,250,45,-20).rotate(-27,350,45,-20).rotate(-18,250,20,-5).rotate(0,300,25,0).rotate(2,275,20,0).rotate(9,265,20,2).rotate(18,255,20,4).rotate(22,245,20,6).rotate(25,325,50,22).rotate(25,250,50,27).rotate(22,205,50,28).rotate(22,155,50,25).rotate(22,150,80,40).delay(1e3)}}),$(".why-so-serious .cart-bg2").coasterscene({size:f>935?1:.75,scene:function(){return this.rotate(152,0,0,0).rotate(143,50,20,-10).rotate(126,75,14,-20).rotate(105,85,10,-20).rotate(85,100,3,-20).rotate(70,55,-3,-20).rotate(58,100,-7,-20).rotate(46,160,-10,-15).rotate(34,190,-16,-15).rotate(24,220,-18,-10).rotate(9,245,-25,-8).rotate(-2,280,-30,-3).rotate(-5,700,-70,4).rotate(0,900,-60,2,"easeOutSine").delay(1500).rotate(0,0,0,0,"linear","addLikes").delay(1500)}}),a.resize(_.throttle(function(){var b;return b=a.width(),f<935&&b>935?($(c.join(", ")).each(function(){return $(this).coasterscene("option","size",1)}),e()):f>935&&b<935&&($(c.join(", ")).each(function(){return $(this).coasterscene("option","size",.75)}),e()),f=b},250)),$("<li>&nbsp;</li>").insertAfter(".folio ul > li:nth-child(4)"),e()})}.call(this);